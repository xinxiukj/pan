# CloudPaste - åœ¨çº¿å‰ªè´´æ¿ ğŸ“‹

<div align="center">
    <img width="100" height="100" src="https://img.icons8.com/dusk/100/paste.png" alt="paste"/>
</div>

<div align="center">
  English | <a href="./README.zh.md">ä¸­æ–‡</a>
</div>

![Cloudflare Workers](https://img.shields.io/badge/Cloudflare-Workers-orange?style=flat-square&logo=cloudflare)
![Vue.js](https://img.shields.io/badge/Vue.js-3.x-green?style=flat-square&logo=vue.js)
![License](https://img.shields.io/badge/License-MIT-blue?style=flat-square)

ä¸€ä¸ªåŸºäº Cloudflare Workers çš„åœ¨çº¿å‰ªè´´æ¿å’Œæ–‡ä»¶åˆ†äº«æœåŠ¡ã€‚æ”¯æŒ Markdownã€å¯†ç ä¿æŠ¤ã€æ–‡ä»¶ä¸Šä¼ ç­‰åŠŸèƒ½ã€‚

<table>
  <tr>
    <td><img src="image/1.png" width="400"/></td>
    <td><img src="image/2.png" width="400"/></td>
  </tr>
  <tr>
    <td><img src="image/3.png" width="400"/></td>
    <td><img src="image/4.png" width="400"/></td>
  </tr>
  <tr>
    <td><img src="image/5.png" width="400"/></td>
    <td><img src="image/6.png" width="400"/></td>
  </tr>
</table>

## âœ¨ åŠŸèƒ½ç‰¹ç‚¹

### ğŸ“ æ–‡æœ¬åˆ†äº«

- æ”¯æŒæ™®é€šæ–‡æœ¬å’Œ Markdown æ ·å¼
- Markdown å®æ—¶é¢„è§ˆå’ŒåŒæ­¥æ»šåŠ¨
- ç¼–è¾‘å™¨æ”¯æŒåŒå‘æ‹‰ä¼¸è°ƒæ•´å¤§å°
- æ”¯æŒå¯†ç ä¿æŠ¤
- å¯é€‰è¿‡æœŸæ—¶é—´
- æ”¯æŒè‡ªå®šä¹‰é“¾æ¥åç¼€ï¼ˆä»…å•æ–‡ä»¶ä¸Šä¼ æ—¶å¯ç”¨ï¼‰
- æ”¯æŒè®¾ç½®è®¿é—®æ¬¡æ•°é™åˆ¶
- æ–‡æœ¬åˆ†äº«æ”¯æŒ pdfã€word æ–‡æ¡£ã€png å›¾ç‰‡å¯¼å‡º
- æ”¯æŒè‡ªåŠ¨ä¿å­˜è‰ç¨¿
  - æµè§ˆå™¨å…³é—­å‰è‡ªåŠ¨ä¿å­˜
  - ä¸‹æ¬¡è®¿é—®æ—¶å¯æ¢å¤
  - æäº¤æˆåŠŸåè‡ªåŠ¨æ¸…é™¤

### ğŸ“ æ–‡ä»¶åˆ†äº«

- æ”¯æŒæ‹–æ‹½ä¸Šä¼ 
- å¤šæ–‡ä»¶ä¸Šä¼ 
- å¯è®¾ç½®å•æ¬¡ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶å’Œæ€»å­˜å‚¨é™åˆ¶
- æ”¯æŒå¯†ç ä¿æŠ¤
- å¯é€‰è¿‡æœŸæ—¶é—´
- å®æ—¶ä¸Šä¼ è¿›åº¦æ˜¾ç¤º
- æ–‡ä»¶é¢„è§ˆåŠŸèƒ½
- ä¸Šä¼ é€Ÿåº¦æ˜¾ç¤º
- æ”¯æŒå–æ¶ˆä¸Šä¼ 
- æ”¯æŒè‡ªå®šä¹‰é“¾æ¥åç¼€ï¼ˆä»…å•æ–‡ä»¶ä¸Šä¼ æ—¶å¯ç”¨ï¼‰
- æ”¯æŒäºŒç»´ç åˆ†äº«å’Œç›´é“¾åˆ†äº«
- æ”¯æŒè®¾ç½®ä¸‹è½½æ¬¡æ•°é™åˆ¶

### ğŸ” è®¿é—®æ§åˆ¶

- ç›‘æ§å­˜å‚¨ç©ºé—´ä½¿ç”¨æƒ…å†µ
- å¯†ç ä¿æŠ¤
  - æ”¯æŒæ–‡æœ¬å’Œæ–‡ä»¶åˆ†äº«è®¾ç½®å¯†ç 
  - ç®¡ç†å‘˜å¯éšæ—¶ä¿®æ”¹æˆ–ç§»é™¤å¯†ç 
  - å¯†ç åŠ å¯†å­˜å‚¨
- æ–‡æœ¬å†…å®¹æ§åˆ¶
  - ä»…ç®¡ç†å‘˜å¯ç¼–è¾‘å·²åˆ†äº«çš„æ–‡æœ¬å†…å®¹
  - æ™®é€šç”¨æˆ·åªèƒ½æŸ¥çœ‹
  - æ”¯æŒä¿®æ”¹è¿‡æœŸæ—¶é—´
  - æ”¯æŒä¿®æ”¹è®¿é—®æ¬¡æ•°é™åˆ¶
- ä¸Šä¼ æ§åˆ¶
  - ç®¡ç†å‘˜å¯å¼€å¯/å…³é—­æ–‡æœ¬ä¸Šä¼ åŠŸèƒ½
  - ç®¡ç†å‘˜å¯å¼€å¯/å…³é—­æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
  - é˜²æ­¢æ¶æ„ä¸Šä¼ å ç”¨èµ„æº

### ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§

- å¯†ç åŠ å¯†å­˜å‚¨
- è®¿é—®æƒé™æ§åˆ¶
- CORS å®‰å…¨é…ç½®
- ä¸Šä¼ é™åˆ¶ä¿æŠ¤
- è‡ªåŠ¨è¿‡æœŸæ¸…ç†
  - å®šæ—¶æ£€æŸ¥è¿‡æœŸå†…å®¹
  - è‡ªåŠ¨åˆ é™¤è¿‡æœŸåˆ†äº«
  - é‡Šæ”¾å­˜å‚¨ç©ºé—´
  - è®¿é—®è§¦å‘æ¸…ç†æ£€æŸ¥

### ğŸ¨ ç•Œé¢ä¼˜åŒ–

- å…¨åˆ†è¾¨ç‡è‡ªé€‚åº”å¸ƒå±€
- ä¼˜åŒ–çš„ç§»åŠ¨ç«¯é€‚é…
- ç¾åŒ–çš„æ»šåŠ¨æ¡æ ·å¼
- å¹³æ»‘çš„åŠ¨ç”»è¿‡æ¸¡æ•ˆæœ
- æ–‡ä»¶ä¸Šä¼ è¿›åº¦åŠ¨ç”»
- å¤åˆ¶æˆåŠŸæç¤ºåŠ¨ç”»
- é”™è¯¯æç¤ºåŠ¨ç”»æ•ˆæœ
- æ‹–æ”¾ä¸Šä¼ è§†è§‰åé¦ˆ
- æš—è‰²ä¸»é¢˜æ”¯æŒï¼ˆæœ‰ç‚¹ç‘•ç–µï¼‰

## ğŸš€ éƒ¨ç½²ï¼ˆè‡ªåŠ¨ï¼‰

### 1. GitHub Actions éƒ¨ç½²(å¯é€‰)

1. **Fork æœ¬ä»“åº“**

   - ç‚¹å‡»å³ä¸Šè§’çš„ Fork æŒ‰é’®
   - ç­‰å¾…ä»“åº“å…‹éš†å®Œæˆ

2. **è®¾ç½® GitHub Secrets**
   åœ¨ä½ çš„ GitHub ä»“åº“ä¸­ï¼Œè½¬åˆ° Settings -> Secrets and variables -> Actions -> New Repository secrets ï¼Œæ·»åŠ ä»¥ä¸‹ secretsï¼š

   - `CF_API_TOKEN`: Cloudflare API ä»¤ç‰Œ

     - è®¿é—® [Cloudflare Dashboard](https://dash.cloudflare.com/profile/api-tokens)
     - åˆ›å»ºæ–°çš„ API ä»¤ç‰Œ -é€‰æ‹©"ç¼–è¾‘ Cloudflare Workers"

   - `CF_ACCOUNT_ID`: Cloudflare è´¦æˆ· ID

     - åœ¨ Cloudflare ä»ªè¡¨æ¿å³ä¾§å¯ä»¥æ‰¾åˆ°

   - `ADMIN_USERNAME`: ç®¡ç†å‘˜ç”¨æˆ·å

     - è®¾ç½®ä½ çš„ç®¡ç†å‘˜è´¦å·

   - `ADMIN_PASSWORD`: ç®¡ç†å‘˜å¯†ç 
     - è®¾ç½®ä½ çš„ç®¡ç†å‘˜å¯†ç 

3. **è¿è¡Œå·¥ä½œæµ**

### 2. ä¸€é”®éƒ¨ç½²

éƒ¨ç½²åé»˜è®¤æ— å¯†ç ,éœ€åœ¨ cloudflare çš„å¯¹åº” worker ä¸‹çš„å˜é‡å’Œæœºå¯†ä¸­è®¾ç½®ï¼š

[![Deploy to Cloudflare Workers](https://deploy.workers.cloudflare.com/button)](https://deploy.workers.cloudflare.com/?url=https://github.com/ling-drag0n/CloudPaste)

## ğŸš€ éƒ¨ç½²ï¼ˆæ‰‹åŠ¨ï¼‰

### 1. å‡†å¤‡å·¥ä½œ

1. æ³¨å†Œ [Cloudflare](https://dash.cloudflare.com) è´¦å·
2. è¿›å…¥ Cloudflare æ§åˆ¶å°

### 2. åˆ›å»ºå­˜å‚¨èµ„æº

1. åˆ›å»º KV å‘½åç©ºé—´

   - åç§°ï¼š`PASTE_STORE`
   - ç”¨äºå­˜å‚¨æ–‡æœ¬å†…å®¹

2. åˆ›å»º KV å‘½åç©ºé—´

   - åç§°ï¼š`UPLOAD_STATUS`
   - ç”¨äºå­˜å‚¨ä¸Šä¼ åŠŸèƒ½çš„å¼€å…³çŠ¶æ€

3. åˆ›å»º R2 å­˜å‚¨æ¡¶
   - åç§°ï¼š`cloudpaste-files`
   - ç”¨äºå­˜å‚¨ä¸Šä¼ çš„æ–‡ä»¶

### 3. åˆ›å»º Worker

1. åˆ›å»ºæ–°çš„ Worker è„šæœ¬

2. é…ç½®ç¯å¢ƒå˜é‡ï¼š

   ```env
   ADMIN_USERNAME=ä½ çš„ç®¡ç†å‘˜ç”¨æˆ·å
   ADMIN_PASSWORD=ä½ çš„ç®¡ç†å‘˜å¯†ç 
   ```

3. ç»‘å®šå­˜å‚¨ï¼š

   - KV ç»‘å®šï¼š

     ```toml
     # æ–‡æœ¬å­˜å‚¨
     å˜é‡åï¼šPASTE_STORE
     é€‰æ‹©åˆ›å»ºçš„ KV å‘½åç©ºé—´

     # ä¸Šä¼ çŠ¶æ€æ§åˆ¶
     å˜é‡åï¼šUPLOAD_STATUS
     é€‰æ‹©åˆ›å»ºçš„ KV å‘½åç©ºé—´
     ```

   - R2 ç»‘å®šï¼š
     ```toml
     å˜é‡åï¼šFILE_STORE
     é€‰æ‹©åˆ›å»ºçš„ R2 å­˜å‚¨æ¡¶
     ```

4. KV å‘½åç©ºé—´è¯´æ˜ï¼š

   - `PASTE_STORE`: ç”¨äºå­˜å‚¨æ–‡æœ¬åˆ†äº«å†…å®¹å’Œå…ƒæ•°æ®
   - `UPLOAD_STATUS`: ç”¨äºå­˜å‚¨å’Œæ§åˆ¶ä¸Šä¼ åŠŸèƒ½çš„å¼€å…³çŠ¶æ€
     - `textUpload`: æ§åˆ¶æ–‡æœ¬ä¸Šä¼ åŠŸèƒ½
     - `fileUpload`: æ§åˆ¶æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
   - `FILE_STORE`: ç”¨äºå­˜å‚¨ä¸Šä¼ çš„æ–‡ä»¶

5. é…ç½®ç¤ºä¾‹ä»£ç  (wrangler.toml):

   ```toml
   [[kv_namespaces]]
   binding = "PASTE_STORE"
   id = "ä½ çš„KVå‘½åç©ºé—´ID"

   [[kv_namespaces]]
   binding = "UPLOAD_STATUS"
   id = "ä½ çš„KVå‘½åç©ºé—´ID"

   [[r2_buckets]]
   bucket_name = "cloudpaste-files"
   binding = "FILE_STORE"
   ```

### 4. éƒ¨ç½²ä»£ç 

1. å¤åˆ¶ `worker.js` çš„å®Œæ•´ä»£ç 
2. ç²˜è´´åˆ° Worker çš„ç¼–è¾‘å™¨ä¸­
3. ä¿å­˜å¹¶éƒ¨ç½²

## ğŸ”§ ä»£ç ç»“æ„è¯´æ˜

### ä¸»è¦ç»„ä»¶

1. `worker.js`

   - ä¸»è¦çš„ Worker ä»£ç 
   - åŒ…å«è·¯ç”±å¤„ç†å’Œ API å®ç°

2. å·¥å…·å‡½æ•°

   - `generateId`: ç”Ÿæˆéšæœº ID
   - `hashPassword`: å¯†ç åŠ å¯†
   - `verifyPassword`: å¯†ç éªŒè¯
   - `calculateExpiryTime`: è®¡ç®—è¿‡æœŸæ—¶é—´
   - `isExpired`: æ£€æŸ¥æ˜¯å¦è¿‡æœŸ

3. å‰ç«¯ç»„ä»¶
   - Vue 3 åº”ç”¨
   - Markdown æ¸²æŸ“
   - ä»£ç é«˜äº®
   - æ–‡ä»¶ä¸Šä¼ ç•Œé¢

### ğŸ“¡ API ç«¯ç‚¹

1. æ–‡æœ¬ç›¸å…³

   ```http
   POST /api/paste     # åˆ›å»ºæ–‡æœ¬åˆ†äº«
   GET  /api/paste/:id # è·å–æ–‡æœ¬å†…å®¹
   ```

2. æ–‡ä»¶ç›¸å…³

   ```http
   POST /api/file      # ä¸Šä¼ æ–‡ä»¶
   GET  /api/file/:id  # è·å–æ–‡ä»¶ä¿¡æ¯
   GET  /api/file/:id?download=true # ä¸‹è½½æ–‡ä»¶
   GET  /download/:id  # ç›´æ¥ä¸‹è½½æ–‡ä»¶
   ```

3. ç®¡ç†ç›¸å…³
   ```http
   POST   /api/admin/login                    # ç®¡ç†å‘˜ç™»å½•
   GET    /api/admin/shares                   # è·å–åˆ†äº«åˆ—è¡¨
   GET    /api/admin/storage                  # è·å–å­˜å‚¨ç©ºé—´ä½¿ç”¨æƒ…å†µ
   DELETE /api/admin/paste/:id                # åˆ é™¤æ–‡æœ¬åˆ†äº«
   DELETE /api/admin/file/:id                 # åˆ é™¤æ–‡ä»¶åˆ†äº«
   PUT    /api/admin/paste/:id/content        # æ›´æ–°æ–‡æœ¬å†…å®¹
   PUT    /api/admin/paste/:id/password       # ä¿®æ”¹æ–‡æœ¬åˆ†äº«å¯†ç 
   PUT    /api/admin/file/:id/password        # ä¿®æ”¹æ–‡ä»¶åˆ†äº«å¯†ç 
   GET    /api/admin/upload-status            # è·å–ä¸Šä¼ çŠ¶æ€
   PUT    /api/admin/upload-status            # æ›´æ–°ä¸Šä¼ çŠ¶æ€
   PUT    /api/admin/file/:id/settings        # ä¿®æ”¹æ–‡ä»¶åˆ†äº«è®¾ç½®
   ```

## ğŸ”„ è‡ªåŠ¨åŒ–åŠŸèƒ½

### è¿‡æœŸå†…å®¹æ¸…ç†

- è‡ªåŠ¨æ£€æµ‹è¿‡æœŸå†…å®¹
- å®šæ—¶æ¸…ç†è¿‡æœŸæ–‡ä»¶å’Œæ–‡æœ¬
- é‡Šæ”¾å­˜å‚¨ç©ºé—´
- æ¯æ•´ç‚¹è‡ªåŠ¨è§¦å‘æ¸…ç†

## âš ï¸ ä½¿ç”¨é™åˆ¶

- æ–‡ä»¶å¤§å°ä¸Šé™ï¼š98MBï¼ˆå¯ä¿®æ”¹ï¼‰
- æ”¯æŒçš„è¿‡æœŸæ—¶é—´ï¼š1 å°æ—¶ã€1 å¤©ã€7 å¤©ã€30 å¤©ï¼Œæ°¸ä¸è¿‡æœŸ
- å¹¶å‘è¯·æ±‚å— Worker é™åˆ¶
- R2 å…è´¹æ€»å­˜å‚¨ç©ºé—´ï¼š10GBï¼ˆå¯ä¿®æ”¹ï¼‰
- åˆ†äº«æ¬¡æ•°è®¿é—®é™åˆ¶ï¼š
  - æ–‡æœ¬åˆ†äº«å¯è®¾ç½®æœ€å¤§è®¿é—®æ¬¡æ•°
  - æ–‡ä»¶åˆ†äº«å¯è®¾ç½®æœ€å¤§ä¸‹è½½æ¬¡æ•°
  - è‡ªå®šä¹‰è®¾ç½®æ¬¡æ•°ï¼Œ0 è¡¨ç¤ºæ— é™åˆ¶
  - è¾¾åˆ°é™åˆ¶æ¬¡æ•°åè‡ªåŠ¨åˆ é™¤
- è‡ªå®šä¹‰é“¾æ¥é™åˆ¶ï¼š
  - ä»…æ”¯æŒå­—æ¯ã€æ•°å­—ã€æ¨ªçº¿å’Œä¸‹åˆ’çº¿
  - ä»…å•æ–‡ä»¶ä¸Šä¼ æ—¶å¯ç”¨
- å­˜å‚¨ç©ºé—´é¢„è­¦ï¼š
  - 70%ä½¿ç”¨ç‡æ—¶æ˜¾ç¤ºè­¦å‘Š
  - 90%ä½¿ç”¨ç‡æ—¶æ˜¾ç¤ºå±é™©æç¤º
  - å­˜å‚¨ç©ºé—´æ»¡æ—¶æ— æ³•ç»§ç»­ä¸Šä¼ 

## ğŸ“ æ³¨æ„äº‹é¡¹

1. ç¡®ä¿æ­£ç¡®é…ç½®ç¯å¢ƒå˜é‡

2. å®šæœŸæ£€æŸ¥å­˜å‚¨ä½¿ç”¨é‡

   - é€šè¿‡ç®¡ç†é¢æ¿ç›‘æ§å­˜å‚¨ç©ºé—´
   - æ³¨æ„å­˜å‚¨ç©ºé—´ä½¿ç”¨ç‡é¢„è­¦
   - åŠæ—¶æ¸…ç†ä¸éœ€è¦çš„å†…å®¹

3. ç›‘æ§é”™è¯¯æ—¥å¿—

4. æ³¨æ„ Worker ä½¿ç”¨é…é¢

5. ç›´é“¾ä¸‹è½½è‹¥è¦åœ¨æœåŠ¡å™¨ä¼ è¾“æ–‡ä»¶

   ```bash
   # ç›´æ¥ä¸‹è½½
   curl -O https://your-domain/download/fileId

   # å¸¦å¯†ç ä¸‹è½½
   curl -H "X-Password: your-password" -O https://your-domain/download/fileId
   ```

## ğŸ› ï¸ ä½¿ç”¨

- Cloudflare Workers
- Cloudflare KV
- Cloudflare R2
- Vue 3
- Marked (Markdown æ¸²æŸ“)
- Highlight.js (ä»£ç é«˜äº®)

## ğŸ“± æµè§ˆå™¨æ”¯æŒ

- Chrome (æ¨è)
- Firefox
- Safari
- Edge
- ç§»åŠ¨ç«¯æµè§ˆå™¨

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ”— ç›¸å…³é“¾æ¥

- [Cloudflare Workers æ–‡æ¡£](https://developers.cloudflare.com/workers/)
- [Vue 3 æ–‡æ¡£](https://v3.vuejs.org/)
- [Marked æ–‡æ¡£](https://marked.js.org/)

## Star History

[![Star History Chart](https://api.star-history.com/svg?repos=ling-drag0n/CloudPaste&type=Date)](https://star-history.com/#ling-drag0n/CloudPaste&Date)
